{% extends 'base.html' %}
{% block title %}Definir Refrigerio{% endblock %}
{% block content %}
<div class="card shadow-sm">
  <div class="card-header card-header-lila"><h3 class="mb-0 text-lila fw-bold">Definir Nueva Plantilla de Refrigerio</h3></div>
  <div class="card-body p-4">
    <form action="{{ url_for('refrigerio_nuevo', casino=casino) }}" method="POST">
      <div class.="row g-3">
        <div class="col-md-4"><label class="form-label">Nombre (ej. Sencillo)</label><input type="text" name="nombre" class="form-control" required></div>
        <div class="col-md-4"><label class="form-label">Turno (ej. Ma√±ana)</label><input type="text" name="turno" class="form-control" required></div>
        <div class="col-md-4"><label class="form-label">Casino</label><select name="casino" class="form-select" required><option value="Casino 1" {% if casino == 'Casino 1' %}selected{% endif %}>Casino 1</option><option value="Casino 2" {% if casino == 'Casino 2' %}selected{% endif %}>Casino 2</option></select></div>
      </div>
      <hr>
      <h5 class="text-lila mt-4">Composici√≥n (qu√© productos incluye y en qu√© cantidad)</h5>
      <div id="items-container">
        <!-- Fila de Producto (se puede clonar con JS) -->
        <div class="row g-2 mb-2 item-row">
          <div class="col-8">
            <label class="form-label">Producto del Inventario</label>
            <select name="producto_id[]" class="form-select">
              <option value="">-- Seleccione un producto --</option>
              {% for p in productos %}<option value="{{ p.id }}">{{ p.nombre }} ({{ p.unidad }})</option>{% endfor %}
            </select>
          </div>
          <div class="col-3"><label class="form-label">Cantidad por Unidad</label><input type="number" step="0.01" name="cantidad[]" class="form-control"></div>
          <div class="col-1 d-flex align-items-end"><button type="button" class="btn btn-sm btn-outline-danger" onclick="this.closest('.item-row').remove()">√ó</button></div>
        </div>
      </div>
      <button type="button" id="add-item" class="btn btn-sm btn-outline-primary mt-2">‚ûï Agregar otro producto</button>
      <div class="text-end mt-4"><a href="{{ url_for('refrigerio_list') }}" class="btn btn-secondary">‚¨ÖÔ∏è Cancelar</a><button type="submit" class="btn btn-lila">üíæ Guardar Plantilla</button></div>
    </form>
  </div>
</div>
<script>
document.getElementById('add-item').addEventListener('click', function() {
    const container = document.getElementById('items-container');
    const firstRow = container.querySelector('.item-row');
    const newRow = firstRow.cloneNode(true);
    newRow.querySelectorAll('select, input').forEach(el => el.value = '');
    container.appendChild(newRow);
});
</script>
{% endblock %}